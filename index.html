<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Life Dashboard</title>
    <!-- PWA MANIFEST -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiTWVybyBKaXZhbiIsInNob3J0X25hbWUiOiJNZXJvIEppdmFuIiwic3RhcnRfdXJsIjoiLyIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwidGhlbWVfY29sb3IiOiIjMDY4OTBhIiwiaWNvbnMiOlt7InNyYyI6Imh0dHBzOi8vcGxhY2Vob2xkLmNvLzEyOHgzMjgvMDY4OTBhL0ZGRiIsInNpemVzIjoiMTI4eDEyOCJ9XX0=">
    <meta name="theme-color" content="#06890a">
    <!-- NOTIFICATION PERMISSION -->
    <script>if ('Notification' in window && Notification.permission === 'default') Notification.requestPermission();</script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React Libraries -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel to compile JSX in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>
        tailwind.config = { darkMode: 'class' }
    </script>
    <style>
        /* Disable zoom on mobile */
        html, body {
            touch-action: pan-y;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        /* Allow scrolling */
        .scroll-container {
            -webkit-overflow-scrolling: touch;
        }
    </style>
</head>
<body class="scroll-container">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useMemo, useRef } = React;

      // --- FIREBASE CONFIGURATION ---
      const firebaseConfig = {
        apiKey: "AIzaSyCwQVdSe_BvFgxwXd4oP6PPOuh6NrJaXNY",
        authDomain: "mero-jivan-cd3a6.firebaseapp.com",
        databaseURL: "https://mero-jivan-cd3a6-default-rtdb.firebaseio.com",
        projectId: "mero-jivan-cd3a6",
        storageBucket: "mero-jivan-cd3a6.firebasestorage.app",
        messagingSenderId: "244728705595",
        appId: "1:244728705595:web:dddc0a53d7cae21bbba21e",
        measurementId: "G-3RVXWQMYTL"
      };

      // Initialize Firebase
      let auth, database;
      try {
        if (!firebase.apps.length) {
          firebase.initializeApp(firebaseConfig);
        }
        auth = firebase.auth();
        database = firebase.database();
        console.log('Firebase initialized successfully');
      } catch (error) {
        console.error('Firebase initialization failed:', error);
      }

      // --- ICONS (as SVG components) ---
      const MoneyIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" /></svg>);
      const LifeIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg>);
      const GrowIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>);
      const AccountIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>);
      const PlusIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>);
      const MinusIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M18 12H6" /></svg>);
      const FoodIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6" /></svg>);
      const TransportIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" /></svg>);
      const BillsIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>);
      const ShoppingIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" /></svg>);
      const FunIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>);
      const HealthIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" /></svg>);
      const OtherIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" /></svg>);
      const SalaryIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" /></svg>);
      const GiftIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}><path strokeLinecap="round" strokeLinejoin="round" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7" /></svg>);
      const BackArrowIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>);
      const EditIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" /></svg>);
      const DeleteIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clipRule="evenodd" /></svg>);
      const GoogleIcon = () => (<svg className="w-4 h-4" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>);
      const MovieIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" /></svg>);
      const BookIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>);
      const ShareIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z" /></svg>);
      const CheckIcon = () => (<svg xmlns="http://www.w3.org/2000/svg" className="h-4 w-4" viewBox="0 0 20 20" fill="currentColor"><path fillRule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clipRule="evenodd" /></svg>);

      // --- DATA & HELPERS ---
      const CATEGORIES = { expense: [{ id: 'food', name: 'Food', Icon: FoodIcon, color: '#FF6384' },{ id: 'transport', name: 'Transport', Icon: TransportIcon, color: '#36A2EB' },{ id: 'home', name: 'Home', Icon: OtherIcon, color: '#FFCE56' },{ id: 'bills', name: 'Bills', Icon: BillsIcon, color: '#4BC0C0' },{ id: 'shopping', name: 'Shopping', Icon: ShoppingIcon, color: '#9966FF' },{ id: 'fun', name: 'Fun', Icon: FunIcon, color: '#FF9F40' },{ id: 'health', name: 'Health', Icon: HealthIcon, color: '#E83E8C' },{ id: 'other_expense', name: 'Other', Icon: OtherIcon, color: '#6C757D' }], income: [{ id: 'salary', name: 'Salary', Icon: SalaryIcon },{ id: 'gift', name: 'Gift', Icon: GiftIcon },{ id: 'other_income', name: 'Other', Icon: OtherIcon }] };
      const ALL_CATEGORIES = [...CATEGORIES.expense, ...CATEGORIES.income].reduce((acc, cat) => { acc[cat.id] = cat; return acc; }, {});
      const NEPALI_MONTH_DATA = { 2070: [30, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31], 2071: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], 2072: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31], 2073: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30], 2074: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], 2075: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31], 2076: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30], 2077: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], 2078: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31], 2079: [31, 31, 32, 32, 31, 30, 29, 30, 29, 30, 29, 31], 2080: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31], 2081: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], 2082: [30, 32, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], 2083: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31], 2084: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30], 2085: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], 2086: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31], 2087: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30], 2088: [31, 31, 32, 31, 31, 31, 30, 29, 30, 29, 30, 30], 2089: [31, 32, 31, 32, 31, 30, 30, 30, 29, 29, 30, 31], 2090: [31, 32, 31, 32, 31, 30, 30, 30, 29, 30, 30, 30] };
      const NEPALI_MONTHS = ['Baishakh','Jestha','Ashadh','Shrawan','Bhadra','Ashwin','Kartik','Mangsir','Poush','Magh','Falgun','Chaitra'];
      const NEPALI_YEAR_START_GREGORIAN_DATE = { 2070: '2013-04-14', 2071: '2014-04-14', 2072: '2015-04-14', 2073: '2016-04-13', 2074: '2017-04-14', 2075: '2018-04-14', 2076: '2019-04-14', 2077: '2020-04-13', 2078: '2021-04-14', 2079: '2022-04-14', 2080: '2023-04-14', 2081: '2024-04-13', 2082: '2025-04-14', 2083: '2026-04-14', 2084: '2027-04-14', 2085: '2028-04-13', 2086: '2029-04-14', 2087: '2030-04-14', 2088: '2031-04-14', 2089: '2032-04-13', 2090: '2033-04-14' };
      const gregorianToNepali = (gregorianDate) => { const defaultDate = { year: 2081, month: 1, day: 1, monthName: 'Baishakh' }; if (!gregorianDate) return defaultDate; const inputDate = new Date(gregorianDate); inputDate.setUTCHours(0, 0, 0, 0); let nepaliYear; const sortedYears = Object.keys(NEPALI_YEAR_START_GREGORIAN_DATE).sort((a, b) => b - a); for (const year of sortedYears) { const startDate = new Date(NEPALI_YEAR_START_GREGORIAN_DATE[year]); startDate.setUTCHours(0, 0, 0, 0); if (inputDate >= startDate) { nepaliYear = parseInt(year); break; } } if (!nepaliYear) return defaultDate; const nepaliYearStartDate = new Date(NEPALI_YEAR_START_GREGORIAN_DATE[nepaliYear]); nepaliYearStartDate.setUTCHours(0, 0, 0, 0); const dayDiff = Math.round((inputDate - nepaliYearStartDate) / (1000 * 60 * 60 * 24)); let nepaliMonth = 1, nepaliDay = dayDiff + 1; const monthDaysData = NEPALI_MONTH_DATA[nepaliYear]; if (!monthDaysData) return defaultDate; for (let i = 0; i < monthDaysData.length; i++) { const daysInMonth = monthDaysData[i]; if (nepaliDay <= daysInMonth) break; else { nepaliDay -= daysInMonth; nepaliMonth++; } } return { year: nepaliYear, month: nepaliMonth, day: nepaliDay, monthName: NEPALI_MONTHS[nepaliMonth - 1] }; };
      const nepaliToGregorian = (nepaliYear, nepaliMonth, nepaliDay) => { const gregorianStartDateStr = NEPALI_YEAR_START_GREGORIAN_DATE[nepaliYear]; if (!gregorianStartDateStr) return new Date().toISOString().split('T')[0]; const gregorianStartDate = new Date(gregorianStartDateStr); let daysToAdd = 0; const monthData = NEPALI_MONTH_DATA[nepaliYear]; if (!monthData) return new Date().toISOString().split('T')[0]; for (let i = 0; i < nepaliMonth - 1; i++) { daysToAdd += monthData[i]; } daysToAdd += nepaliDay - 1; const resultDate = new Date(gregorianStartDate.getTime()); resultDate.setDate(gregorianStartDate.getDate() + daysToAdd); return resultDate.toISOString().split('T')[0]; };
      
      // ENHANCED WORKOUT DATA WITH REAL EXERCISES AND CORRECT GIFs
      const WORKOUT_DATA = {
          'Chest': [
              { 
                  id: 1, 
                  name: 'Barbell Bench Press', 
                  description: 'Lie on a flat bench with feet firmly on the ground. Grip barbell slightly wider than shoulder width. Lower bar to chest, then press back up explosively. Keep your back flat and maintain proper form throughout the movement.',
                  gif: 'https://i.ibb.co/0j1Wq2L/bench-press.gif',
                  equipment: 'Barbell, Bench',
                  difficulty: 'Intermediate'
              },
              { 
                  id: 2, 
                  name: 'Incline Dumbbell Press', 
                  description: 'Lie on incline bench (30-45 degrees). Press dumbbells upward until arms are extended. Lower with control to chest level. This targets the upper chest muscles effectively.',
                  gif: 'https://i.ibb.co/7YfL1ZR/incline-dumbbell-press.gif',
                  equipment: 'Dumbbells, Incline Bench',
                  difficulty: 'Beginner'
              },
              { 
                  id: 3, 
                  name: 'Push-ups', 
                  description: 'Start in plank position with hands shoulder-width apart. Lower body until chest nearly touches floor, keeping elbows close to body. Push back up to start position while maintaining a straight body line.',
                  gif: 'https://i.ibb.co/0QY1q1L/push-ups.gif',
                  equipment: 'Bodyweight',
                  difficulty: 'Beginner'
              }
          ],
          'Back': [
              { 
                  id: 4, 
                  name: 'Pull-ups', 
                  description: 'Hang from bar with overhand grip, hands wider than shoulders. Pull body up until chin is above bar. Lower with control back to starting position. Engage your back muscles throughout the movement.',
                  gif: 'https://i.ibb.co/0QY1q1L/pull-ups.gif',
                  equipment: 'Pull-up Bar',
                  difficulty: 'Advanced'
              },
              { 
                  id: 5, 
                  name: 'Bent Over Barbell Row', 
                  description: 'Stand with feet shoulder-width apart, bend knees slightly. Hinge at hips until torso is nearly parallel to floor. Pull barbell to lower chest while squeezing shoulder blades together.',
                  gif: 'https://i.ibb.co/0QY1q1L/bent-over-row.gif',
                  equipment: 'Barbell',
                  difficulty: 'Intermediate'
              },
              { 
                  id: 6, 
                  name: 'Lat Pulldown', 
                  description: 'Sit at lat pulldown machine with knees secured under pads. Grip bar wide, pull down to upper chest while leaning back slightly. Focus on using your back muscles, not your arms.',
                  gif: 'https://i.ibb.co/0QY1q1L/lat-pulldown.gif',
                  equipment: 'Cable Machine',
                  difficulty: 'Beginner'
              }
          ],
          'Shoulders': [
              { 
                  id: 7, 
                  name: 'Overhead Press', 
                  description: 'Stand with barbell at shoulder level, hands slightly wider than shoulders. Press barbell overhead until arms are fully extended. Lower with control. Keep your core tight throughout the movement.',
                  gif: 'https://i.ibb.co/0QY1q1L/overhead-press.gif',
                  equipment: 'Barbell',
                  difficulty: 'Intermediate'
              },
              { 
                  id: 8, 
                  name: 'Dumbbell Lateral Raise', 
                  description: 'Stand holding dumbbells at sides with palms facing each other. Raise arms out to sides until parallel with floor. Lower with control. Use light weights and focus on proper form.',
                  gif: 'https://i.ibb.co/0QY1q1L/lateral-raise.gif',
                  equipment: 'Dumbbells',
                  difficulty: 'Beginner'
              }
          ],
          'Biceps': [
              { 
                  id: 9, 
                  name: 'Barbell Curl', 
                  description: 'Stand holding barbell with underhand grip, hands shoulder-width apart. Curl weight up to shoulder level while keeping elbows stationary. Squeeze biceps at the top, then lower with control.',
                  gif: 'https://i.ibb.co/0QY1q1L/barbell-curl.gif',
                  equipment: 'Barbell',
                  difficulty: 'Beginner'
              },
              { 
                  id: 10, 
                  name: 'Hammer Curl', 
                  description: 'Hold dumbbells with palms facing each other (neutral grip). Curl weights up while maintaining neutral grip position. This targets both biceps and brachialis muscles.',
                  gif: 'https://i.ibb.co/0QY1q1L/hammer-curl.gif',
                  equipment: 'Dumbbells',
                  difficulty: 'Beginner'
              }
          ],
          'Triceps': [
              { 
                  id: 11, 
                  name: 'Tricep Dips', 
                  description: 'Use parallel bars or bench. Lower body by bending elbows until shoulders are slightly below elbows. Push back up to starting position. Keep your body upright to target triceps.',
                  gif: 'https://i.ibb.co/0QY1q1L/tricep-dips.gif',
                  equipment: 'Parallel Bars/Bench',
                  difficulty: 'Intermediate'
              },
              { 
                  id: 12, 
                  name: 'Skull Crushers', 
                  description: 'Lie on bench holding barbell or dumbbells above chest. Lower weight toward forehead by bending elbows. Extend arms back to starting position. Keep elbows stationary.',
                  gif: 'https://i.ibb.co/0QY1q1L/skull-crushers.gif',
                  equipment: 'Barbell/Dumbbells, Bench',
                  difficulty: 'Intermediate'
              }
          ],
          'Legs': [
              { 
                  id: 13, 
                  name: 'Barbell Squat', 
                  description: 'Stand with barbell across upper back, feet shoulder-width apart. Lower hips back and down as if sitting in a chair. Keep chest up and back straight. Descend until thighs are parallel to floor, then drive back up.',
                  gif: 'https://i.ibb.co/0QY1q1L/barbell-squat.gif',
                  equipment: 'Barbell',
                  difficulty: 'Intermediate'
              },
              { 
                  id: 14, 
                  name: 'Romanian Deadlift', 
                  description: 'Hold barbell with overhand grip, feet hip-width apart. Keeping back straight, hinge at hips to lower barbell down legs. Lower until you feel stretch in hamstrings, then return to standing position.',
                  gif: 'https://i.ibb.co/0QY1q1L/romanian-deadlift.gif',
                  equipment: 'Barbell',
                  difficulty: 'Intermediate'
              },
              { 
                  id: 15, 
                  name: 'Walking Lunges', 
                  description: 'Stand with feet together, step forward with one leg and lower hips until both knees are bent at 90-degree angles. Push off back foot to bring it forward into next lunge. Alternate legs as you move forward.',
                  gif: 'https://i.ibb.co/0QY1q1L/walking-lunges.gif',
                  equipment: 'Bodyweight/Dumbbells',
                  difficulty: 'Beginner'
              }
          ],
          'Core': [
              { 
                  id: 16, 
                  name: 'Plank', 
                  description: 'Lie face down, then lift body onto toes and forearms. Keep body in straight line from head to heels. Engage core muscles and hold position without letting hips sag or rise.',
                  gif: 'https://i.ibb.co/0QY1q1L/plank.gif',
                  equipment: 'Bodyweight',
                  difficulty: 'Beginner'
              },
              { 
                  id: 17, 
                  name: 'Russian Twists', 
                  description: 'Sit on floor with knees bent, lean back slightly to engage core. Hold weight with both hands and twist torso from side to side. Keep movements controlled and avoid using momentum.',
                  gif: 'https://i.ibb.co/0QY1q1L/russian-twists.gif',
                  equipment: 'Bodyweight/Weight',
                  difficulty: 'Beginner'
              }
          ]
      };

      // --- STORAGE & SYNC FUNCTIONS ---
      const getLocalStorage = (key, defaultValue = null) => {
          try {
              const item = localStorage.getItem(key);
              return item ? JSON.parse(item) : defaultValue;
          } catch (error) {
              console.error('Error reading from localStorage:', error);
              return defaultValue;
          }
      };

      const setLocalStorage = (key, value) => {
          try {
              localStorage.setItem(key, JSON.stringify(value));
          } catch (error) {
              console.error('Error writing to localStorage:', error);
          }
      };

      const removeLocalStorage = (key) => {
          try {
              localStorage.removeItem(key);
          } catch (error) {
              console.error('Error removing from localStorage:', error);
          }
      };

      // --- FIREBASE SYNC FUNCTIONS ---
      const syncWithFirebase = async (userId, data) => {
          if (!database || !userId) return false;
          try {
              await database.ref(`users/${userId}`).set(data);
              console.log('Data synced to Firebase');
              return true;
          } catch (error) {
              console.error('Error syncing with Firebase:', error);
              return false;
          }
      };

      const loadFromFirebase = async (userId) => {
          if (!database || !userId) return null;
          try {
              const snapshot = await database.ref(`users/${userId}`).once('value');
              return snapshot.exists() ? snapshot.val() : null;
          } catch (error) {
              console.error('Error loading from Firebase:', error);
              return null;
          }
      };

      // --- MAIN APP COMPONENT ---
      function App() {
          const [user, setUser] = useState(null);
          const [activeTab, setActiveTab] = useState('money');
          const [darkMode, setDarkMode] = useState(false);
          const [userData, setUserData] = useState({ money: { transactions: [], balance: 0 }, life: { goals: [], tasks: [] }, grow: { books: [], series: [] }, lendBorrow: { lend: [], borrow: [] } });
          const [isLoading, setIsLoading] = useState(true);
          const [lastSyncTime, setLastSyncTime] = useState(null);
          const [syncStatus, setSyncStatus] = useState('idle'); // 'idle', 'syncing', 'success', 'error'
          const [showSyncAnimation, setShowSyncAnimation] = useState(false);

          // Initialize app
          useEffect(() => {
              // Check for saved user preference
              const savedDarkMode = getLocalStorage('darkMode', false);
              setDarkMode(savedDarkMode);
              
              // Apply dark mode class to body
              if (savedDarkMode) {
                  document.body.classList.add('dark');
              } else {
                  document.body.classList.remove('dark');
              }
              
              // Check for existing authentication
              if (auth) {
                  const unsubscribe = auth.onAuthStateChanged(async (firebaseUser) => {
                      if (firebaseUser) {
                          console.log('User logged in:', firebaseUser.uid);
                          setUser(firebaseUser);
                          
                          // Load data from Firebase immediately
                          setIsLoading(true);
                          const firebaseData = await loadFromFirebase(firebaseUser.uid);
                          
                          if (firebaseData) {
                              console.log('Data loaded from Firebase');
                              setUserData(firebaseData);
                              setLocalStorage('userData', firebaseData);
                          } else {
                              // Fallback to local storage if Firebase data doesn't exist
                              const localData = getLocalStorage('userData', { money: { transactions: [], balance: 0 }, life: { goals: [], tasks: [] }, grow: { books: [], series: [] }, lendBorrow: { lend: [], borrow: [] } });
                              setUserData(localData);
                              // Sync local data to Firebase
                              await syncWithFirebase(firebaseUser.uid, localData);
                          }
                          
                          setIsLoading(false);
                          setLastSyncTime(new Date());
                      } else {
                          console.log('No user logged in');
                          setUser(null);
                          setIsLoading(false);
                      }
                  });
                  
                  return () => unsubscribe();
              } else {
                  setIsLoading(false);
              }
          }, []);

          // Update user data and sync with Firebase
          const updateUserData = async (newData) => {
              setUserData(newData);
              setLocalStorage('userData', newData);
              
              if (user) {
                  setSyncStatus('syncing');
                  const success = await syncWithFirebase(user.uid, newData);
                  setSyncStatus(success ? 'success' : 'error');
                  if (success) {
                      setLastSyncTime(new Date());
                      setShowSyncAnimation(true);
                      setTimeout(() => setShowSyncAnimation(false), 2000);
                  }
              }
          };

          // Handle user login
          const handleLogin = async (email, password) => {
              if (!auth) {
                  alert('Firebase not initialized. Please check your connection.');
                  return false;
              }
              
              try {
                  const result = await auth.signInWithEmailAndPassword(email, password);
                  setUser(result.user);
                  return true;
              } catch (error) {
                  console.error('Login error:', error);
                  alert(`Login failed: ${error.message}`);
                  return false;
              }
          };

          // Handle user signup
          const handleSignup = async (email, password) => {
              if (!auth) {
                  alert('Firebase not initialized. Please check your connection.');
                  return false;
              }
              
              try {
                  const result = await auth.createUserWithEmailAndPassword(email, password);
                  setUser(result.user);
                  
                  // Initialize user data in Firebase
                  const initialData = { money: { transactions: [], balance: 0 }, life: { goals: [], tasks: [] }, grow: { books: [], series: [] }, lendBorrow: { lend: [], borrow: [] } };
                  await syncWithFirebase(result.user.uid, initialData);
                  setUserData(initialData);
                  setLocalStorage('userData', initialData);
                  
                  return true;
              } catch (error) {
                  console.error('Signup error:', error);
                  alert(`Signup failed: ${error.message}`);
                  return false;
              }
          };

          // Handle Google login
          const handleGoogleLogin = async () => {
              if (!auth || !firebase.auth.GoogleAuthProvider) {
                  alert('Google authentication not available. Please check your connection.');
                  return false;
              }
              
              try {
                  const provider = new firebase.auth.GoogleAuthProvider();
                  const result = await auth.signInWithPopup(provider);
                  setUser(result.user);
                  
                  // Load data from Firebase or initialize
                  const firebaseData = await loadFromFirebase(result.user.uid);
                  if (firebaseData) {
                      setUserData(firebaseData);
                      setLocalStorage('userData', firebaseData);
                  } else {
                      const initialData = { money: { transactions: [], balance: 0 }, life: { goals: [], tasks: [] }, grow: { books: [], series: [] }, lendBorrow: { lend: [], borrow: [] } };
                      await syncWithFirebase(result.user.uid, initialData);
                      setUserData(initialData);
                      setLocalStorage('userData', initialData);
                  }
                  
                  return true;
              } catch (error) {
                  console.error('Google login error:', error);
                  alert(`Google login failed: ${error.message}`);
                  return false;
              }
          };

          // Handle user logout with auto-refresh
          const handleLogout = async () => {
              if (auth) {
                  try {
                      await auth.signOut();
                  } catch (error) {
                      console.error('Logout error:', error);
                  }
              }
              
              // Clear local storage
              removeLocalStorage('userData');
              
              // Reset user state
              setUser(null);
              setUserData({ money: { transactions: [], balance: 0 }, life: { goals: [], tasks: [] }, grow: { books: [], series: [] }, lendBorrow: { lend: [], borrow: [] } });
              
              // Force page refresh to clear any cached state
              window.location.reload();
          };

          // Toggle dark mode
          const toggleDarkMode = () => {
              const newDarkMode = !darkMode;
              setDarkMode(newDarkMode);
              setLocalStorage('darkMode', newDarkMode);
              
              if (newDarkMode) {
                  document.body.classList.add('dark');
              } else {
                  document.body.classList.remove('dark');
              }
          };

          // Manual sync function
          const handleManualSync = async () => {
              if (user) {
                  setSyncStatus('syncing');
                  const success = await syncWithFirebase(user.uid, userData);
                  setSyncStatus(success ? 'success' : 'error');
                  if (success) {
                      setLastSyncTime(new Date());
                      setShowSyncAnimation(true);
                      setTimeout(() => setShowSyncAnimation(false), 2000);
                  }
              }
          };

          // Render loading screen
          if (isLoading) {
              return (
                  <div className={`min-h-screen flex items-center justify-center ${darkMode ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-800'}`}>
                      <div className="text-center">
                          <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto"></div>
                          <p className="mt-4">Loading...</p>
                      </div>
                  </div>
              );
          }

          // Render login/signup screen if user is not logged in
          if (!user) {
              return (
                  <AuthScreen 
                      onLogin={handleLogin} 
                      onSignup={handleSignup} 
                      onGoogleLogin={handleGoogleLogin}
                      darkMode={darkMode} 
                  />
              );
          }

          // Main app interface
          return (
              <div className={`min-h-screen transition-colors duration-200 ${darkMode ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-800'}`}>
                  {/* Header */}
                  <header className={`sticky top-0 z-10 ${darkMode ? 'bg-gray-800' : 'bg-white'} shadow-sm`}>
                      <div className="container mx-auto px-4 py-3 flex justify-between items-center">
                          <h1 className="text-xl font-bold text-green-500">Mero Jivan</h1>
                          <div className="flex items-center space-x-4">
                              {/* Sync Indicator */}
                              <div className="flex items-center">
                                  {syncStatus === 'syncing' && (
                                      <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-green-500"></div>
                                  )}
                                  {syncStatus === 'success' && showSyncAnimation && (
                                      <div className="text-green-500 animate-pulse">‚úì</div>
                                  )}
                                  {syncStatus === 'error' && (
                                      <div className="text-red-500">‚ö†</div>
                                  )}
                                  {lastSyncTime && (
                                      <button 
                                          onClick={handleManualSync}
                                          className="ml-2 text-xs text-gray-500 hover:text-green-500"
                                          title="Sync Now"
                                      >
                                          {lastSyncTime.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                                      </button>
                                  )}
                              </div>
                              
                              {/* Dark Mode Toggle */}
                              <button 
                                  onClick={toggleDarkMode}
                                  className={`p-2 rounded-full ${darkMode ? 'bg-gray-700 text-yellow-300' : 'bg-gray-200 text-gray-700'}`}
                              >
                                  {darkMode ? '‚òÄÔ∏è' : 'üåô'}
                              </button>
                              
                              {/* User Menu */}
                              <div className="relative group">
                                  <button className="flex items-center space-x-1 focus:outline-none">
                                      <AccountIcon />
                                      <span className="text-sm">{user.email.split('@')[0]}</span>
                                  </button>
                                  <div className={`absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 ${darkMode ? 'bg-gray-800' : 'bg-white'} ring-1 ring-black ring-opacity-5 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200`}>
                                      <button 
                                          onClick={handleLogout}
                                          className={`block w-full text-left px-4 py-2 text-sm ${darkMode ? 'text-white hover:bg-gray-700' : 'text-gray-700 hover:bg-gray-100'}`}
                                      >
                                          Logout
                                      </button>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </header>

                  {/* Navigation Tabs */}
                  <nav className={`sticky top-14 z-10 ${darkMode ? 'bg-gray-800' : 'bg-white'} shadow-sm`}>
                      <div className="container mx-auto px-4">
                          <div className="flex overflow-x-auto">
                              {[
                                  { id: 'money', label: 'Money', icon: MoneyIcon },
                                  { id: 'life', label: 'Life', icon: LifeIcon },
                                  { id: 'grow', label: 'Grow', icon: GrowIcon },
                                  { id: 'lendBorrow', label: 'Lend/Borrow', icon: AccountIcon }
                              ].map(tab => (
                                  <button
                                      key={tab.id}
                                      onClick={() => setActiveTab(tab.id)}
                                      className={`flex items-center px-4 py-3 border-b-2 font-medium text-sm whitespace-nowrap ${
                                          activeTab === tab.id 
                                              ? 'border-green-500 text-green-600' 
                                              : `border-transparent ${darkMode ? 'text-gray-300 hover:text-gray-100' : 'text-gray-500 hover:text-gray-700'}`
                                      }`}
                                  >
                                      <tab.icon />
                                      <span className="ml-2">{tab.label}</span>
                                  </button>
                              ))}
                          </div>
                      </div>
                  </nav>

                  {/* Main Content */}
                  <main className="container mx-auto px-4 py-6">
                      {activeTab === 'money' && (
                          <MoneyTab 
                              data={userData.money} 
                              updateData={(newMoneyData) => updateUserData({...userData, money: newMoneyData})}
                              darkMode={darkMode} 
                          />
                      )}
                      {activeTab === 'life' && (
                          <LifeTab 
                              data={userData.life} 
                              updateData={(newLifeData) => updateUserData({...userData, life: newLifeData})}
                              darkMode={darkMode} 
                          />
                      )}
                      {activeTab === 'grow' && (
                          <GrowTab 
                              data={userData.grow} 
                              updateData={(newGrowData) => updateUserData({...userData, grow: newGrowData})}
                              darkMode={darkMode} 
                          />
                      )}
                      {activeTab === 'lendBorrow' && (
                          <LendBorrowTab 
                              data={userData.lendBorrow} 
                              updateData={(newLendBorrowData) => updateUserData({...userData, lendBorrow: newLendBorrowData})}
                              darkMode={darkMode} 
                          />
                      )}
                  </main>
              </div>
          );
      }

      // --- AUTHENTICATION SCREEN ---
      function AuthScreen({ onLogin, onSignup, onGoogleLogin, darkMode }) {
          const [isLogin, setIsLogin] = useState(true);
          const [email, setEmail] = useState('');
          const [password, setPassword] = useState('');
          const [confirmPassword, setConfirmPassword] = useState('');
          const [isLoading, setIsLoading] = useState(false);

          const handleSubmit = async (e) => {
              e.preventDefault();
              if (!email || !password) {
                  alert('Please enter both email and password');
                  return;
              }
              
              if (!isLogin && password !== confirmPassword) {
                  alert('Passwords do not match');
                  return;
              }
              
              setIsLoading(true);
              const success = isLogin ? await onLogin(email, password) : await onSignup(email, password);
              setIsLoading(false);
              
              if (!success) {
                  // Reset form on failure
                  setPassword('');
                  setConfirmPassword('');
              }
          };

          const handleGoogleAuth = async () => {
              setIsLoading(true);
              await onGoogleLogin();
              setIsLoading(false);
          };

          return (
              <div className={`min-h-screen flex items-center justify-center px-4 ${darkMode ? 'bg-gray-900' : 'bg-gray-50'}`}>
                  <div className={`max-w-md w-full ${darkMode ? 'bg-gray-800' : 'bg-white'} rounded-lg shadow-md overflow-hidden`}>
                      <div className="p-6">
                          <div className="text-center mb-6">
                              <h2 className="text-2xl font-bold text-green-500">Mero Jivan</h2>
                              <p className={`mt-2 ${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>
                                  {isLogin ? 'Sign in to your account' : 'Create a new account'}
                              </p>
                          </div>

                          <form onSubmit={handleSubmit} className="space-y-4">
                              <div>
                                  <label htmlFor="email" className={`block text-sm font-medium ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                      Email
                                  </label>
                                  <input
                                      type="email"
                                      id="email"
                                      value={email}
                                      onChange={(e) => setEmail(e.target.value)}
                                      className={`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                          darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                      }`}
                                      placeholder="you@example.com"
                                      required
                                  />
                              </div>

                              <div>
                                  <label htmlFor="password" className={`block text-sm font-medium ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                      Password
                                  </label>
                                  <input
                                      type="password"
                                      id="password"
                                      value={password}
                                      onChange={(e) => setPassword(e.target.value)}
                                      className={`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                          darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                      }`}
                                      placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                      required
                                  />
                              </div>

                              {!isLogin && (
                                  <div>
                                      <label htmlFor="confirmPassword" className={`block text-sm font-medium ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                          Confirm Password
                                      </label>
                                      <input
                                          type="password"
                                          id="confirmPassword"
                                          value={confirmPassword}
                                          onChange={(e) => setConfirmPassword(e.target.value)}
                                          className={`mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                          placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                                          required
                                      />
                                  </div>
                              )}

                              <button
                                  type="submit"
                                  disabled={isLoading}
                                  className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"
                              >
                                  {isLoading ? 'Please wait...' : (isLogin ? 'Sign in' : 'Sign up')}
                              </button>
                          </form>

                          <div className="mt-4">
                              <div className="relative">
                                  <div className="absolute inset-0 flex items-center">
                                      <div className={`w-full border-t ${darkMode ? 'border-gray-600' : 'border-gray-300'}`}></div>
                                  </div>
                                  <div className="relative flex justify-center text-sm">
                                      <span className={`px-2 ${darkMode ? 'bg-gray-800 text-gray-400' : 'bg-white text-gray-500'}`}>
                                          Or continue with
                                      </span>
                                  </div>
                              </div>

                              <div className="mt-4">
                                  <button
                                      onClick={handleGoogleAuth}
                                      disabled={isLoading}
                                      className="w-full flex items-center justify-center px-4 py-2 border rounded-md shadow-sm text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50"
                                      style={{ 
                                          backgroundColor: darkMode ? '#374151' : 'white',
                                          borderColor: darkMode ? '#4B5563' : '#D1D5DB',
                                          color: darkMode ? 'white' : '#374151'
                                      }}
                                  >
                                      <GoogleIcon />
                                      <span className="ml-2">Google</span>
                                  </button>
                              </div>
                          </div>

                          <div className="mt-4 text-center">
                              <button
                                  onClick={() => {
                                      setIsLogin(!isLogin);
                                      setPassword('');
                                      setConfirmPassword('');
                                  }}
                                  className={`text-sm ${darkMode ? 'text-green-400 hover:text-green-300' : 'text-green-600 hover:text-green-500'}`}
                              >
                                  {isLogin ? "Don't have an account? Sign up" : "Already have an account? Sign in"}
                              </button>
                          </div>
                      </div>
                  </div>
              </div>
          );
      }

      // --- MONEY TAB COMPONENT ---
      function MoneyTab({ data, updateData, darkMode }) {
          const [transactions, setTransactions] = useState(data.transactions || []);
          const [balance, setBalance] = useState(data.balance || 0);
          const [showAddForm, setShowAddForm] = useState(false);
          const [editingTransaction, setEditingTransaction] = useState(null);
          const [newTransaction, setNewTransaction] = useState({ type: 'expense', category: 'food', amount: '', description: '', date: new Date().toISOString().split('T')[0] });
          const [selectedMonth, setSelectedMonth] = useState(new Date().getMonth() + 1);
          const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());
          const [filterType, setFilterType] = useState('all');
          const [filterCategory, setFilterCategory] = useState('all');

          // Update local state when props change
          useEffect(() => {
              setTransactions(data.transactions || []);
              setBalance(data.balance || 0);
          }, [data]);

          // Calculate balance from transactions
          useEffect(() => {
              const calculatedBalance = transactions.reduce((total, transaction) => {
                  return transaction.type === 'income' ? total + transaction.amount : total - transaction.amount;
              }, 0);
              setBalance(calculatedBalance);
          }, [transactions]);

          // Save to parent when data changes
          useEffect(() => {
              updateData({ transactions, balance });
          }, [transactions, balance]);

          const handleAddTransaction = () => {
              if (!newTransaction.amount || !newTransaction.description) {
                  alert('Please fill in all fields');
                  return;
              }

              const transaction = {
                  id: editingTransaction ? editingTransaction.id : Date.now().toString(),
                  type: newTransaction.type,
                  category: newTransaction.category,
                  amount: parseFloat(newTransaction.amount),
                  description: newTransaction.description,
                  date: newTransaction.date
              };

              let updatedTransactions;
              if (editingTransaction) {
                  updatedTransactions = transactions.map(t => 
                      t.id === editingTransaction.id ? transaction : t
                  );
              } else {
                  updatedTransactions = [...transactions, transaction];
              }

              setTransactions(updatedTransactions);
              setShowAddForm(false);
              setEditingTransaction(null);
              setNewTransaction({ type: 'expense', category: 'food', amount: '', description: '', date: new Date().toISOString().split('T')[0] });
          };

          const handleEditTransaction = (transaction) => {
              setEditingTransaction(transaction);
              setNewTransaction({
                  type: transaction.type,
                  category: transaction.category,
                  amount: transaction.amount.toString(),
                  description: transaction.description,
                  date: transaction.date
              });
              setShowAddForm(true);
          };

          const handleDeleteTransaction = (id) => {
              if (confirm('Are you sure you want to delete this transaction?')) {
                  const updatedTransactions = transactions.filter(t => t.id !== id);
                  setTransactions(updatedTransactions);
              }
          };

          const handleCancel = () => {
              setShowAddForm(false);
              setEditingTransaction(null);
              setNewTransaction({ type: 'expense', category: 'food', amount: '', description: '', date: new Date().toISOString().split('T')[0] });
          };

          // Filter transactions by month, year, type, and category
          const filteredTransactions = transactions.filter(transaction => {
              const transactionDate = new Date(transaction.date);
              const transactionMonth = transactionDate.getMonth() + 1;
              const transactionYear = transactionDate.getFullYear();
              
              const monthMatch = transactionMonth === selectedMonth && transactionYear === selectedYear;
              const typeMatch = filterType === 'all' || transaction.type === filterType;
              const categoryMatch = filterCategory === 'all' || transaction.category === filterCategory;
              
              return monthMatch && typeMatch && categoryMatch;
          });

          // Calculate income and expenses for the selected period
          const periodIncome = filteredTransactions
              .filter(t => t.type === 'income')
              .reduce((sum, t) => sum + t.amount, 0);
              
          const periodExpenses = filteredTransactions
              .filter(t => t.type === 'expense')
              .reduce((sum, t) => sum + t.amount, 0);

          // Get current month and year for display
          const currentMonth = new Date().toLocaleString('default', { month: 'long' });
          const currentYear = new Date().getFullYear();

          return (
              <div>
                  {/* Balance Card */}
                  <div className={`rounded-lg shadow-md p-6 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                      <div className="flex justify-between items-center">
                          <div>
                              <h2 className="text-2xl font-bold">Current Balance</h2>
                              <p className={`text-3xl font-bold mt-2 ${balance >= 0 ? 'text-green-500' : 'text-red-500'}`}>
                                  Rs. {balance.toFixed(2)}
                              </p>
                          </div>
                          <button
                              onClick={() => setShowAddForm(true)}
                              className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center"
                          >
                              <PlusIcon />
                              <span className="ml-2">Add Transaction</span>
                          </button>
                      </div>
                      
                      {/* Period Summary */}
                      <div className="grid grid-cols-2 gap-4 mt-4">
                          <div className={`p-3 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-green-50'}`}>
                              <p className="text-sm text-gray-500">Income ({currentMonth})</p>
                              <p className="text-lg font-semibold text-green-500">Rs. {periodIncome.toFixed(2)}</p>
                          </div>
                          <div className={`p-3 rounded-lg ${darkMode ? 'bg-gray-700' : 'bg-red-50'}`}>
                              <p className="text-sm text-gray-500">Expenses ({currentMonth})</p>
                              <p className="text-lg font-semibold text-red-500">Rs. {periodExpenses.toFixed(2)}</p>
                          </div>
                      </div>
                  </div>

                  {/* Filters */}
                  <div className={`rounded-lg shadow-md p-4 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                          <div>
                              <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Month</label>
                              <select
                                  value={selectedMonth}
                                  onChange={(e) => setSelectedMonth(parseInt(e.target.value))}
                                  className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                      darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                  }`}
                              >
                                  {Array.from({ length: 12 }, (_, i) => (
                                      <option key={i+1} value={i+1}>
                                          {new Date(2000, i).toLocaleString('default', { month: 'long' })}
                                      </option>
                                  ))}
                              </select>
                          </div>
                          <div>
                              <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Year</label>
                              <select
                                  value={selectedYear}
                                  onChange={(e) => setSelectedYear(parseInt(e.target.value))}
                                  className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                      darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                  }`}
                              >
                                  {Array.from({ length: 5 }, (_, i) => {
                                      const year = currentYear - 2 + i;
                                      return <option key={year} value={year}>{year}</option>;
                                  })}
                              </select>
                          </div>
                          <div>
                              <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Type</label>
                              <select
                                  value={filterType}
                                  onChange={(e) => setFilterType(e.target.value)}
                                  className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                      darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                  }`}
                              >
                                  <option value="all">All Types</option>
                                  <option value="income">Income</option>
                                  <option value="expense">Expense</option>
                              </select>
                          </div>
                          <div>
                              <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Category</label>
                              <select
                                  value={filterCategory}
                                  onChange={(e) => setFilterCategory(e.target.value)}
                                  className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                      darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                  }`}
                              >
                                  <option value="all">All Categories</option>
                                  {Object.values(ALL_CATEGORIES).map(cat => (
                                      <option key={cat.id} value={cat.id}>{cat.name}</option>
                                  ))}
                              </select>
                          </div>
                      </div>
                  </div>

                  {/* Add/Edit Transaction Form */}
                  {showAddForm && (
                      <div className={`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50`}>
                          <div className={`rounded-lg shadow-xl w-full max-w-md ${darkMode ? 'bg-gray-800' : 'bg-white'} p-6`}>
                              <h3 className="text-lg font-bold mb-4">
                                  {editingTransaction ? 'Edit Transaction' : 'Add New Transaction'}
                              </h3>
                              
                              <div className="space-y-4">
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Type</label>
                                      <div className="flex space-x-4">
                                          <label className="flex items-center">
                                              <input
                                                  type="radio"
                                                  value="income"
                                                  checked={newTransaction.type === 'income'}
                                                  onChange={(e) => setNewTransaction({...newTransaction, type: e.target.value})}
                                                  className="mr-2"
                                              />
                                              <span>Income</span>
                                          </label>
                                          <label className="flex items-center">
                                              <input
                                                  type="radio"
                                                  value="expense"
                                                  checked={newTransaction.type === 'expense'}
                                                  onChange={(e) => setNewTransaction({...newTransaction, type: e.target.value})}
                                                  className="mr-2"
                                              />
                                              <span>Expense</span>
                                          </label>
                                      </div>
                                  </div>
                                  
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Category</label>
                                      <select
                                          value={newTransaction.category}
                                          onChange={(e) => setNewTransaction({...newTransaction, category: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                      >
                                          {CATEGORIES[newTransaction.type].map(cat => (
                                              <option key={cat.id} value={cat.id}>{cat.name}</option>
                                          ))}
                                      </select>
                                  </div>
                                  
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Amount (Rs.)</label>
                                      <input
                                          type="number"
                                          value={newTransaction.amount}
                                          onChange={(e) => setNewTransaction({...newTransaction, amount: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                          placeholder="0.00"
                                      />
                                  </div>
                                  
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Description</label>
                                      <input
                                          type="text"
                                          value={newTransaction.description}
                                          onChange={(e) => setNewTransaction({...newTransaction, description: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                          placeholder="What was this for?"
                                      />
                                  </div>
                                  
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Date</label>
                                      <input
                                          type="date"
                                          value={newTransaction.date}
                                          onChange={(e) => setNewTransaction({...newTransaction, date: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                      />
                                  </div>
                              </div>
                              
                              <div className="flex justify-end space-x-3 mt-6">
                                  <button
                                      onClick={handleCancel}
                                      className={`px-4 py-2 border rounded-md ${
                                          darkMode ? 'border-gray-600 text-gray-300 hover:bg-gray-700' : 'border-gray-300 text-gray-700 hover:bg-gray-50'
                                      }`}
                                  >
                                      Cancel
                                  </button>
                                  <button
                                      onClick={handleAddTransaction}
                                      className="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600"
                                  >
                                      {editingTransaction ? 'Update' : 'Add'} Transaction
                                  </button>
                              </div>
                          </div>
                      </div>
                  )}

                  {/* Transactions List */}
                  <div className={`rounded-lg shadow-md overflow-hidden ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                      <div className="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                          <h3 className="text-lg font-medium">Transactions</h3>
                      </div>
                      
                      {filteredTransactions.length === 0 ? (
                          <div className="p-6 text-center text-gray-500">
                              No transactions found for the selected period and filters.
                          </div>
                      ) : (
                          <div className="divide-y divide-gray-200 dark:divide-gray-700">
                              {filteredTransactions.map(transaction => {
                                  const CategoryIcon = ALL_CATEGORIES[transaction.category]?.Icon || OtherIcon;
                                  const categoryColor = ALL_CATEGORIES[transaction.category]?.color || '#6C757D';
                                  
                                  return (
                                      <div key={transaction.id} className="p-4 flex items-center justify-between">
                                          <div className="flex items-center">
                                              <div 
                                                  className="p-2 rounded-full mr-3"
                                                  style={{ backgroundColor: `${categoryColor}20` }}
                                              >
                                                  <CategoryIcon />
                                              </div>
                                              <div>
                                                  <p className="font-medium">{transaction.description}</p>
                                                  <div className="flex items-center text-sm text-gray-500">
                                                      <span>{ALL_CATEGORIES[transaction.category]?.name}</span>
                                                      <span className="mx-2">‚Ä¢</span>
                                                      <span>{new Date(transaction.date).toLocaleDateString()}</span>
                                                  </div>
                                              </div>
                                          </div>
                                          
                                          <div className="flex items-center">
                                              <span className={`font-semibold mr-3 ${
                                                  transaction.type === 'income' ? 'text-green-500' : 'text-red-500'
                                              }`}>
                                                  {transaction.type === 'income' ? '+' : '-'}Rs. {transaction.amount.toFixed(2)}
                                              </span>
                                              <div className="flex space-x-2">
                                                  <button
                                                      onClick={() => handleEditTransaction(transaction)}
                                                      className="p-1 text-blue-500 hover:text-blue-700"
                                                  >
                                                      <EditIcon />
                                                  </button>
                                                  <button
                                                      onClick={() => handleDeleteTransaction(transaction.id)}
                                                      className="p-1 text-red-500 hover:text-red-700"
                                                  >
                                                      <DeleteIcon />
                                                  </button>
                                              </div>
                                          </div>
                                      </div>
                                  );
                              })}
                          </div>
                      )}
                  </div>
              </div>
          );
      }

      // --- LIFE TAB COMPONENT ---
      function LifeTab({ data, updateData, darkMode }) {
          const [goals, setGoals] = useState(data.goals || []);
          const [tasks, setTasks] = useState(data.tasks || []);
          const [newGoal, setNewGoal] = useState({ title: '', targetDate: '', priority: 'medium' });
          const [newTask, setNewTask] = useState({ title: '', dueDate: '', priority: 'medium' });
          const [activeSection, setActiveSection] = useState('goals');

          // Update local state when props change
          useEffect(() => {
              setGoals(data.goals || []);
              setTasks(data.tasks || []);
          }, [data]);

          // Save to parent when data changes
          useEffect(() => {
              updateData({ goals, tasks });
          }, [goals, tasks]);

          const addGoal = () => {
              if (!newGoal.title.trim()) return;
              const goal = {
                  id: Date.now().toString(),
                  title: newGoal.title,
                  targetDate: newGoal.targetDate,
                  priority: newGoal.priority,
                  completed: false,
                  createdAt: new Date().toISOString()
              };
              setGoals([...goals, goal]);
              setNewGoal({ title: '', targetDate: '', priority: 'medium' });
          };

          const addTask = () => {
              if (!newTask.title.trim()) return;
              const task = {
                  id: Date.now().toString(),
                  title: newTask.title,
                  dueDate: newTask.dueDate,
                  priority: newTask.priority,
                  completed: false,
                  createdAt: new Date().toISOString()
              };
              setTasks([...tasks, task]);
              setNewTask({ title: '', dueDate: '', priority: 'medium' });
          };

          const toggleGoalCompletion = (id) => {
              setGoals(goals.map(goal => 
                  goal.id === id ? { ...goal, completed: !goal.completed } : goal
              ));
          };

          const toggleTaskCompletion = (id) => {
              setTasks(tasks.map(task => 
                  task.id === id ? { ...task, completed: !task.completed } : task
              ));
          };

          const deleteGoal = (id) => {
              if (confirm('Are you sure you want to delete this goal?')) {
                  setGoals(goals.filter(goal => goal.id !== id));
              }
          };

          const deleteTask = (id) => {
              if (confirm('Are you sure you want to delete this task?')) {
                  setTasks(tasks.filter(task => task.id !== id));
              }
          };

          const editGoal = (id, newTitle) => {
              setGoals(goals.map(goal => 
                  goal.id === id ? { ...goal, title: newTitle } : goal
              ));
          };

          const editTask = (id, newTitle) => {
              setTasks(tasks.map(task => 
                  task.id === id ? { ...task, title: newTitle } : task
              ));
          };

          const getPriorityColor = (priority) => {
              switch (priority) {
                  case 'high': return 'red';
                  case 'medium': return 'yellow';
                  case 'low': return 'green';
                  default: return 'gray';
              }
          };

          return (
              <div>
                  {/* Section Toggle */}
                  <div className="flex mb-6 bg-gray-200 dark:bg-gray-700 rounded-lg p-1">
                      <button
                          onClick={() => setActiveSection('goals')}
                          className={`flex-1 py-2 px-4 rounded-md text-sm font-medium ${
                              activeSection === 'goals' 
                                  ? 'bg-white dark:bg-gray-600 shadow' 
                                  : 'text-gray-600 dark:text-gray-300'
                          }`}
                      >
                          Goals
                      </button>
                      <button
                          onClick={() => setActiveSection('tasks')}
                          className={`flex-1 py-2 px-4 rounded-md text-sm font-medium ${
                              activeSection === 'tasks' 
                                  ? 'bg-white dark:bg-gray-600 shadow' 
                                  : 'text-gray-600 dark:text-gray-300'
                          }`}
                      >
                          Tasks
                      </button>
                  </div>

                  {activeSection === 'goals' ? (
                      <div>
                          {/* Add Goal Form */}
                          <div className={`rounded-lg shadow-md p-6 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                              <h3 className="text-lg font-medium mb-4">Add New Goal</h3>
                              <div className="space-y-4">
                                  <div>
                                      <input
                                          type="text"
                                          value={newGoal.title}
                                          onChange={(e) => setNewGoal({...newGoal, title: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                          placeholder="What do you want to achieve?"
                                      />
                                  </div>
                                  <div className="grid grid-cols-2 gap-4">
                                      <div>
                                          <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Target Date</label>
                                          <input
                                              type="date"
                                              value={newGoal.targetDate}
                                              onChange={(e) => setNewGoal({...newGoal, targetDate: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                          />
                                      </div>
                                      <div>
                                          <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Priority</label>
                                          <select
                                              value={newGoal.priority}
                                              onChange={(e) => setNewGoal({...newGoal, priority: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                          >
                                              <option value="low">Low</option>
                                              <option value="medium">Medium</option>
                                              <option value="high">High</option>
                                          </select>
                                      </div>
                                  </div>
                                  <button
                                      onClick={addGoal}
                                      className="w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600"
                                  >
                                      Add Goal
                                  </button>
                              </div>
                          </div>

                          {/* Goals List */}
                          <div className={`rounded-lg shadow-md overflow-hidden ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                              <div className="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                                  <h3 className="text-lg font-medium">My Goals ({goals.filter(g => !g.completed).length} pending)</h3>
                              </div>
                              
                              {goals.length === 0 ? (
                                  <div className="p-6 text-center text-gray-500">
                                      No goals yet. Add your first goal above!
                                  </div>
                              ) : (
                                  <div className="divide-y divide-gray-200 dark:divide-gray-700">
                                      {goals.map(goal => (
                                          <div key={goal.id} className="p-4 flex items-center justify-between">
                                              <div className="flex items-center">
                                                  <input
                                                      type="checkbox"
                                                      checked={goal.completed}
                                                      onChange={() => toggleGoalCompletion(goal.id)}
                                                      className="h-5 w-5 text-green-500 rounded focus:ring-green-500"
                                                  />
                                                  <div className="ml-3">
                                                      <p className={`font-medium ${goal.completed ? 'line-through text-gray-500' : ''}`}>
                                                          {goal.title}
                                                      </p>
                                                      <div className="flex items-center text-sm text-gray-500 mt-1">
                                                          {goal.targetDate && (
                                                              <span>Target: {new Date(goal.targetDate).toLocaleDateString()}</span>
                                                          )}
                                                          <span className={`mx-2 px-2 py-1 rounded-full text-xs bg-${getPriorityColor(goal.priority)}-100 text-${getPriorityColor(goal.priority)}-800`}>
                                                              {goal.priority}
                                                          </span>
                                                      </div>
                                                  </div>
                                              </div>
                                              
                                              <div className="flex space-x-2">
                                                  <button
                                                      onClick={() => {
                                                          const newTitle = prompt('Edit goal:', goal.title);
                                                          if (newTitle && newTitle.trim()) {
                                                              editGoal(goal.id, newTitle.trim());
                                                          }
                                                      }}
                                                      className="p-1 text-blue-500 hover:text-blue-700"
                                                  >
                                                      <EditIcon />
                                                  </button>
                                                  <button
                                                      onClick={() => deleteGoal(goal.id)}
                                                      className="p-1 text-red-500 hover:text-red-700"
                                                  >
                                                      <DeleteIcon />
                                                  </button>
                                              </div>
                                          </div>
                                      ))}
                                  </div>
                              )}
                          </div>
                      </div>
                  ) : (
                      <div>
                          {/* Add Task Form */}
                          <div className={`rounded-lg shadow-md p-6 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                              <h3 className="text-lg font-medium mb-4">Add New Task</h3>
                              <div className="space-y-4">
                                  <div>
                                      <input
                                          type="text"
                                          value={newTask.title}
                                          onChange={(e) => setNewTask({...newTask, title: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                          placeholder="What needs to be done?"
                                      />
                                  </div>
                                  <div className="grid grid-cols-2 gap-4">
                                      <div>
                                          <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Due Date</label>
                                          <input
                                              type="date"
                                              value={newTask.dueDate}
                                              onChange={(e) => setNewTask({...newTask, dueDate: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                          />
                                      </div>
                                      <div>
                                          <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Priority</label>
                                          <select
                                              value={newTask.priority}
                                              onChange={(e) => setNewTask({...newTask, priority: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                          >
                                              <option value="low">Low</option>
                                              <option value="medium">Medium</option>
                                              <option value="high">High</option>
                                          </select>
                                      </div>
                                  </div>
                                  <button
                                      onClick={addTask}
                                      className="w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600"
                                  >
                                      Add Task
                                  </button>
                              </div>
                          </div>

                          {/* Tasks List */}
                          <div className={`rounded-lg shadow-md overflow-hidden ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                              <div className="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                                  <h3 className="text-lg font-medium">My Tasks ({tasks.filter(t => !t.completed).length} pending)</h3>
                              </div>
                              
                              {tasks.length === 0 ? (
                                  <div className="p-6 text-center text-gray-500">
                                      No tasks yet. Add your first task above!
                                  </div>
                              ) : (
                                  <div className="divide-y divide-gray-200 dark:divide-gray-700">
                                      {tasks.map(task => (
                                          <div key={task.id} className="p-4 flex items-center justify-between">
                                              <div className="flex items-center">
                                                  <input
                                                      type="checkbox"
                                                      checked={task.completed}
                                                      onChange={() => toggleTaskCompletion(task.id)}
                                                      className="h-5 w-5 text-green-500 rounded focus:ring-green-500"
                                                  />
                                                  <div className="ml-3">
                                                      <p className={`font-medium ${task.completed ? 'line-through text-gray-500' : ''}`}>
                                                          {task.title}
                                                      </p>
                                                      <div className="flex items-center text-sm text-gray-500 mt-1">
                                                          {task.dueDate && (
                                                              <span>Due: {new Date(task.dueDate).toLocaleDateString()}</span>
                                                          )}
                                                          <span className={`mx-2 px-2 py-1 rounded-full text-xs bg-${getPriorityColor(task.priority)}-100 text-${getPriorityColor(task.priority)}-800`}>
                                                              {task.priority}
                                                          </span>
                                                      </div>
                                                  </div>
                                              </div>
                                              
                                              <div className="flex space-x-2">
                                                  <button
                                                      onClick={() => {
                                                          const newTitle = prompt('Edit task:', task.title);
                                                          if (newTitle && newTitle.trim()) {
                                                              editTask(task.id, newTitle.trim());
                                                          }
                                                      }}
                                                      className="p-1 text-blue-500 hover:text-blue-700"
                                                  >
                                                      <EditIcon />
                                                  </button>
                                                  <button
                                                      onClick={() => deleteTask(task.id)}
                                                      className="p-1 text-red-500 hover:text-red-700"
                                                  >
                                                      <DeleteIcon />
                                                  </button>
                                              </div>
                                          </div>
                                      ))}
                                  </div>
                              )}
                          </div>
                      </div>
                  )}
              </div>
          );
      }

      // --- GROW TAB COMPONENT ---
      function GrowTab({ data, updateData, darkMode }) {
          const [books, setBooks] = useState(data.books || []);
          const [series, setSeries] = useState(data.series || []);
          const [activeSection, setActiveSection] = useState('books');
          const [newBook, setNewBook] = useState({ title: '', author: '', status: 'want-to-read', rating: 0 });
          const [newSeries, setNewSeries] = useState({ title: '', platform: '', status: 'want-to-watch', rating: 0 });
          const [showWorkoutModal, setShowWorkoutModal] = useState(false);
          const [selectedMuscleGroup, setSelectedMuscleGroup] = useState(null);
          const [selectedExercise, setSelectedExercise] = useState(null);

          // Update local state when props change
          useEffect(() => {
              setBooks(data.books || []);
              setSeries(data.series || []);
          }, [data]);

          // Save to parent when data changes
          useEffect(() => {
              updateData({ books, series });
          }, [books, series]);

          const addBook = () => {
              if (!newBook.title.trim()) return;
              const book = {
                  id: Date.now().toString(),
                  title: newBook.title,
                  author: newBook.author,
                  status: newBook.status,
                  rating: newBook.rating,
                  createdAt: new Date().toISOString()
              };
              setBooks([...books, book]);
              setNewBook({ title: '', author: '', status: 'want-to-read', rating: 0 });
          };

          const addSeries = () => {
              if (!newSeries.title.trim()) return;
              const seriesItem = {
                  id: Date.now().toString(),
                  title: newSeries.title,
                  platform: newSeries.platform,
                  status: newSeries.status,
                  rating: newSeries.rating,
                  createdAt: new Date().toISOString()
              };
              setSeries([...series, seriesItem]);
              setNewSeries({ title: '', platform: '', status: 'want-to-watch', rating: 0 });
          };

          const deleteBook = (id) => {
              if (confirm('Are you sure you want to delete this book?')) {
                  setBooks(books.filter(book => book.id !== id));
              }
          };

          const deleteSeries = (id) => {
              if (confirm('Are you sure you want to delete this series?')) {
                  setSeries(series.filter(seriesItem => seriesItem.id !== id));
              }
          };

          const editBook = (id, field, value) => {
              setBooks(books.map(book => 
                  book.id === id ? { ...book, [field]: value } : book
              ));
          };

          const editSeries = (id, field, value) => {
              setSeries(series.map(seriesItem => 
                  seriesItem.id === id ? { ...seriesItem, [field]: value } : seriesItem
              ));
          };

          const getStatusColor = (status) => {
              switch (status) {
                  case 'completed': return 'green';
                  case 'in-progress': return 'blue';
                  case 'want-to-read':
                  case 'want-to-watch': return 'gray';
                  default: return 'gray';
              }
          };

          const renderStars = (rating, onChange = null, size = 'sm') => {
              return (
                  <div className="flex">
                      {[1, 2, 3, 4, 5].map(star => (
                          <button
                              key={star}
                              type="button"
                              onClick={() => onChange && onChange(star)}
                              className={`${onChange ? 'cursor-pointer' : 'cursor-default'} ${
                                  size === 'sm' ? 'text-sm' : 'text-lg'
                              } ${star <= rating ? 'text-yellow-400' : 'text-gray-300'}`}
                              disabled={!onChange}
                          >
                              ‚òÖ
                          </button>
                      ))}
                  </div>
              );
          };

          return (
              <div>
                  {/* Section Toggle */}
                  <div className="flex mb-6 bg-gray-200 dark:bg-gray-700 rounded-lg p-1">
                      <button
                          onClick={() => setActiveSection('books')}
                          className={`flex-1 py-2 px-4 rounded-md text-sm font-medium ${
                              activeSection === 'books' 
                                  ? 'bg-white dark:bg-gray-600 shadow' 
                                  : 'text-gray-600 dark:text-gray-300'
                          }`}
                      >
                          <BookIcon className="inline w-4 h-4 mr-2" />
                          Books
                      </button>
                      <button
                          onClick={() => setActiveSection('series')}
                          className={`flex-1 py-2 px-4 rounded-md text-sm font-medium ${
                              activeSection === 'series' 
                                  ? 'bg-white dark:bg-gray-600 shadow' 
                                  : 'text-gray-600 dark:text-gray-300'
                          }`}
                      >
                          <MovieIcon className="inline w-4 h-4 mr-2" />
                          Series
                      </button>
                      <button
                          onClick={() => setShowWorkoutModal(true)}
                          className={`flex-1 py-2 px-4 rounded-md text-sm font-medium ${
                              activeSection === 'workout' 
                                  ? 'bg-white dark:bg-gray-600 shadow' 
                                  : 'text-gray-600 dark:text-gray-300'
                          }`}
                      >
                          <GrowIcon className="inline w-4 h-4 mr-2" />
                          Workout
                      </button>
                  </div>

                  {activeSection === 'books' ? (
                      <div>
                          {/* Add Book Form */}
                          <div className={`rounded-lg shadow-md p-6 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                              <h3 className="text-lg font-medium mb-4">Add New Book</h3>
                              <div className="space-y-4">
                                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                      <div>
                                          <input
                                              type="text"
                                              value={newBook.title}
                                              onChange={(e) => setNewBook({...newBook, title: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                              placeholder="Book Title"
                                          />
                                      </div>
                                      <div>
                                          <input
                                              type="text"
                                              value={newBook.author}
                                              onChange={(e) => setNewBook({...newBook, author: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                              placeholder="Author"
                                          />
                                      </div>
                                  </div>
                                  <div className="grid grid-cols-2 gap-4">
                                      <div>
                                          <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Status</label>
                                          <select
                                              value={newBook.status}
                                              onChange={(e) => setNewBook({...newBook, status: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                          >
                                              <option value="want-to-read">Want to Read</option>
                                              <option value="in-progress">Reading</option>
                                              <option value="completed">Completed</option>
                                          </select>
                                      </div>
                                      <div>
                                          <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Rating</label>
                                          {renderStars(newBook.rating, (rating) => setNewBook({...newBook, rating}), 'lg')}
                                      </div>
                                  </div>
                                  <button
                                      onClick={addBook}
                                      className="w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600"
                                  >
                                      Add Book
                                  </button>
                              </div>
                          </div>

                          {/* Books List */}
                          <div className={`rounded-lg shadow-md overflow-hidden ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                              <div className="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                                  <h3 className="text-lg font-medium">My Books ({books.filter(b => b.status === 'completed').length} completed)</h3>
                              </div>
                              
                              {books.length === 0 ? (
                                  <div className="p-6 text-center text-gray-500">
                                      No books yet. Add your first book above!
                                  </div>
                              ) : (
                                  <div className="divide-y divide-gray-200 dark:divide-gray-700">
                                      {books.map(book => (
                                          <div key={book.id} className="p-4 flex items-center justify-between">
                                              <div className="flex-1">
                                                  <div className="flex items-center justify-between">
                                                      <div>
                                                          <p className="font-medium">{book.title}</p>
                                                          <p className="text-sm text-gray-500">{book.author}</p>
                                                      </div>
                                                      
                                                      <div className="flex items-center space-x-4">
                                                          <span className={`px-2 py-1 rounded-full text-xs bg-${getStatusColor(book.status)}-100 text-${getStatusColor(book.status)}-800 capitalize`}>
                                                              {book.status.replace('-', ' ')}
                                                          </span>
                                                          
                                                          {renderStars(book.rating)}
                                                          
                                                          <div className="flex space-x-2">
                                                              <button
                                                                  onClick={() => {
                                                                      const newTitle = prompt('Edit book title:', book.title);
                                                                      if (newTitle && newTitle.trim()) {
                                                                          editBook(book.id, 'title', newTitle.trim());
                                                                      }
                                                                  }}
                                                                  className="p-1 text-blue-500 hover:text-blue-700"
                                                              >
                                                                  <EditIcon />
                                                              </button>
                                                              <button
                                                                  onClick={() => deleteBook(book.id)}
                                                                  className="p-1 text-red-500 hover:text-red-700"
                                                              >
                                                                  <DeleteIcon />
                                                              </button>
                                                          </div>
                                                      </div>
                                                  </div>
                                                  
                                                  <div className="mt-2 flex space-x-4 text-sm">
                                                      <select
                                                          value={book.status}
                                                          onChange={(e) => editBook(book.id, 'status', e.target.value)}
                                                          className={`text-xs px-2 py-1 border rounded ${
                                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                                          }`}
                                                      >
                                                          <option value="want-to-read">Want to Read</option>
                                                          <option value="in-progress">Reading</option>
                                                          <option value="completed">Completed</option>
                                                      </select>
                                                      
                                                      <div className="flex items-center">
                                                          <span className="mr-2">Rating:</span>
                                                          {renderStars(book.rating, (rating) => editBook(book.id, 'rating', rating))}
                                                      </div>
                                                  </div>
                                              </div>
                                          </div>
                                      ))}
                                  </div>
                              )}
                          </div>
                      </div>
                  ) : (
                      <div>
                          {/* Add Series Form */}
                          <div className={`rounded-lg shadow-md p-6 mb-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                              <h3 className="text-lg font-medium mb-4">Add New Series/Movie</h3>
                              <div className="space-y-4">
                                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                      <div>
                                          <input
                                              type="text"
                                              value={newSeries.title}
                                              onChange={(e) => setNewSeries({...newSeries, title: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                              placeholder="Series/Movie Title"
                                          />
                                      </div>
                                      <div>
                                          <input
                                              type="text"
                                              value={newSeries.platform}
                                              onChange={(e) => setNewSeries({...newSeries, platform: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                              placeholder="Platform (Netflix, YouTube, etc.)"
                                          />
                                      </div>
                                  </div>
                                  <div className="grid grid-cols-2 gap-4">
                                      <div>
                                          <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Status</label>
                                          <select
                                              value={newSeries.status}
                                              onChange={(e) => setNewSeries({...newSeries, status: e.target.value})}
                                              className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                                  darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                              }`}
                                          >
                                              <option value="want-to-watch">Want to Watch</option>
                                              <option value="in-progress">Watching</option>
                                              <option value="completed">Completed</option>
                                          </select>
                                      </div>
                                      <div>
                                          <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>Rating</label>
                                          {renderStars(newSeries.rating, (rating) => setNewSeries({...newSeries, rating}), 'lg')}
                                      </div>
                                  </div>
                                  <button
                                      onClick={addSeries}
                                      className="w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600"
                                  >
                                      Add Series/Movie
                                  </button>
                              </div>
                          </div>

                          {/* Series List */}
                          <div className={`rounded-lg shadow-md overflow-hidden ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                              <div className="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                                  <h3 className="text-lg font-medium">My Series & Movies ({series.filter(s => s.status === 'completed').length} completed)</h3>
                              </div>
                              
                              {series.length === 0 ? (
                                  <div className="p-6 text-center text-gray-500">
                                      No series or movies yet. Add your first one above!
                                  </div>
                              ) : (
                                  <div className="divide-y divide-gray-200 dark:divide-gray-700">
                                      {series.map(seriesItem => (
                                          <div key={seriesItem.id} className="p-4 flex items-center justify-between">
                                              <div className="flex-1">
                                                  <div className="flex items-center justify-between">
                                                      <div>
                                                          <p className="font-medium">{seriesItem.title}</p>
                                                          <p className="text-sm text-gray-500">{seriesItem.platform}</p>
                                                      </div>
                                                      
                                                      <div className="flex items-center space-x-4">
                                                          <span className={`px-2 py-1 rounded-full text-xs bg-${getStatusColor(seriesItem.status)}-100 text-${getStatusColor(seriesItem.status)}-800 capitalize`}>
                                                              {seriesItem.status.replace('-', ' ')}
                                                          </span>
                                                          
                                                          {renderStars(seriesItem.rating)}
                                                          
                                                          <div className="flex space-x-2">
                                                              <button
                                                                  onClick={() => {
                                                                      const newTitle = prompt('Edit series title:', seriesItem.title);
                                                                      if (newTitle && newTitle.trim()) {
                                                                          editSeries(seriesItem.id, 'title', newTitle.trim());
                                                                      }
                                                                  }}
                                                                  className="p-1 text-blue-500 hover:text-blue-700"
                                                              >
                                                                  <EditIcon />
                                                              </button>
                                                              <button
                                                                  onClick={() => deleteSeries(seriesItem.id)}
                                                                  className="p-1 text-red-500 hover:text-red-700"
                                                              >
                                                                  <DeleteIcon />
                                                              </button>
                                                          </div>
                                                      </div>
                                                  </div>
                                                  
                                                  <div className="mt-2 flex space-x-4 text-sm">
                                                      <select
                                                          value={seriesItem.status}
                                                          onChange={(e) => editSeries(seriesItem.id, 'status', e.target.value)}
                                                          className={`text-xs px-2 py-1 border rounded ${
                                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                                          }`}
                                                      >
                                                          <option value="want-to-watch">Want to Watch</option>
                                                          <option value="in-progress">Watching</option>
                                                          <option value="completed">Completed</option>
                                                      </select>
                                                      
                                                      <div className="flex items-center">
                                                          <span className="mr-2">Rating:</span>
                                                          {renderStars(seriesItem.rating, (rating) => editSeries(seriesItem.id, 'rating', rating))}
                                                      </div>
                                                  </div>
                                              </div>
                                          </div>
                                      ))}
                                  </div>
                              )}
                          </div>
                      </div>
                  )}

                  {/* Workout Modal */}
                  {showWorkoutModal && (
                      <WorkoutModal 
                          darkMode={darkMode} 
                          onClose={() => {
                              setShowWorkoutModal(false);
                              setSelectedMuscleGroup(null);
                              setSelectedExercise(null);
                          }}
                          selectedMuscleGroup={selectedMuscleGroup}
                          setSelectedMuscleGroup={setSelectedMuscleGroup}
                          selectedExercise={selectedExercise}
                          setSelectedExercise={setSelectedExercise}
                      />
                  )}
              </div>
          );
      }

      // --- WORKOUT MODAL COMPONENT ---
      function WorkoutModal({ darkMode, onClose, selectedMuscleGroup, setSelectedMuscleGroup, selectedExercise, setSelectedExercise }) {
          return (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                  <div className={`rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                      {/* Header */}
                      <div className="px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center">
                          <h3 className="text-lg font-bold">Workout Exercises</h3>
                          <button
                              onClick={onClose}
                              className={`p-2 rounded-full ${darkMode ? 'hover:bg-gray-700' : 'hover:bg-gray-100'}`}
                          >
                              <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                  <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                              </svg>
                          </button>
                      </div>
                      
                      {/* Content */}
                      <div className="p-6 overflow-auto max-h-[calc(90vh-80px)]">
                          {!selectedMuscleGroup ? (
                              // Muscle Groups Grid
                              <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                  {Object.keys(WORKOUT_DATA).map(muscleGroup => (
                                      <button
                                          key={muscleGroup}
                                          onClick={() => setSelectedMuscleGroup(muscleGroup)}
                                          className={`p-4 rounded-lg text-center transition-all hover:scale-105 ${
                                              darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-100 hover:bg-gray-200'
                                          }`}
                                      >
                                          <div className="text-lg font-medium mb-2">{muscleGroup}</div>
                                          <div className="text-sm text-gray-500">
                                              {WORKOUT_DATA[muscleGroup].length} exercises
                                          </div>
                                      </button>
                                  ))}
                              </div>
                          ) : !selectedExercise ? (
                              // Exercises List for Selected Muscle Group
                              <div>
                                  <button
                                      onClick={() => setSelectedMuscleGroup(null)}
                                      className="flex items-center text-green-500 mb-4"
                                  >
                                      <BackArrowIcon />
                                      <span className="ml-2">Back to Muscle Groups</span>
                                  </button>
                                  
                                  <h4 className="text-xl font-bold mb-4">{selectedMuscleGroup} Exercises</h4>
                                  
                                  <div className="space-y-4">
                                      {WORKOUT_DATA[selectedMuscleGroup].map(exercise => (
                                          <div
                                              key={exercise.id}
                                              className={`p-4 rounded-lg cursor-pointer transition-all hover:scale-[1.02] ${
                                                  darkMode ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-100 hover:bg-gray-200'
                                              }`}
                                              onClick={() => setSelectedExercise(exercise)}
                                          >
                                              <div className="flex justify-between items-start">
                                                  <div>
                                                      <h5 className="font-semibold text-lg">{exercise.name}</h5>
                                                      <div className="flex items-center mt-2 space-x-4 text-sm text-gray-500">
                                                          <span>Equipment: {exercise.equipment}</span>
                                                          <span>‚Ä¢</span>
                                                          <span>Difficulty: {exercise.difficulty}</span>
                                                      </div>
                                                  </div>
                                                  <div className="text-right">
                                                      <div className="text-green-500">View Details ‚Üí</div>
                                                  </div>
                                              </div>
                                          </div>
                                      ))}
                                  </div>
                              </div>
                          ) : (
                              // Exercise Details
                              <div>
                                  <button
                                      onClick={() => setSelectedExercise(null)}
                                      className="flex items-center text-green-500 mb-4"
                                  >
                                      <BackArrowIcon />
                                      <span className="ml-2">Back to {selectedMuscleGroup} Exercises</span>
                                  </button>
                                  
                                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                      <div>
                                          <h4 className="text-2xl font-bold mb-2">{selectedExercise.name}</h4>
                                          <div className="flex items-center space-x-4 mb-4 text-sm">
                                              <span className={`px-3 py-1 rounded-full ${
                                                  darkMode ? 'bg-gray-700' : 'bg-gray-200'
                                              }`}>
                                                  Equipment: {selectedExercise.equipment}
                                              </span>
                                              <span className={`px-3 py-1 rounded-full ${
                                                  selectedExercise.difficulty === 'Beginner' ? 'bg-green-100 text-green-800' :
                                                  selectedExercise.difficulty === 'Intermediate' ? 'bg-yellow-100 text-yellow-800' :
                                                  'bg-red-100 text-red-800'
                                              }`}>
                                                  {selectedExercise.difficulty}
                                              </span>
                                          </div>
                                          
                                          <div className={`p-4 rounded-lg mb-4 ${darkMode ? 'bg-gray-700' : 'bg-gray-100'}`}>
                                              <h5 className="font-semibold mb-2">Description</h5>
                                              <p className="text-sm leading-relaxed">{selectedExercise.description}</p>
                                          </div>
                                      </div>
                                      
                                      <div className="flex items-center justify-center">
                                          <div className="w-full max-w-sm">
                                              <img 
                                                  src={selectedExercise.gif} 
                                                  alt={selectedExercise.name}
                                                  className="w-full h-64 object-cover rounded-lg shadow-md"
                                                  onError={(e) => {
                                                      e.target.src = 'https://via.placeholder.com/300x200/374151/FFFFFF?text=Exercise+Image';
                                                  }}
                                              />
                                          </div>
                                      </div>
                                  </div>
                              </div>
                          )}
                      </div>
                  </div>
              </div>
          );
      }

      // --- LEND/BORROW TAB COMPONENT ---
      function LendBorrowTab({ data, updateData, darkMode }) {
          const [lendList, setLendList] = useState(data.lend || []);
          const [borrowList, setBorrowList] = useState(data.borrow || []);
          const [activeSection, setActiveSection] = useState('lend');
          const [showAddForm, setShowAddForm] = useState(false);
          const [editingItem, setEditingItem] = useState(null);
          const [newItem, setNewItem] = useState({ 
              person: '', 
              amount: '', 
              description: '', 
              date: new Date().toISOString().split('T')[0],
              paid: false 
          });

          // Update local state when props change
          useEffect(() => {
              setLendList(data.lend || []);
              setBorrowList(data.borrow || []);
          }, [data]);

          // Save to parent when data changes
          useEffect(() => {
              updateData({ lend: lendList, borrow: borrowList });
          }, [lendList, borrowList]);

          const handleAddItem = () => {
              if (!newItem.person || !newItem.amount) {
                  alert('Please fill in person and amount');
                  return;
              }

              const item = {
                  id: editingItem ? editingItem.id : Date.now().toString(),
                  person: newItem.person,
                  amount: parseFloat(newItem.amount),
                  description: newItem.description,
                  date: newItem.date,
                  paid: newItem.paid
              };

              if (activeSection === 'lend') {
                  let updatedList;
                  if (editingItem) {
                      updatedList = lendList.map(l => 
                          l.id === editingItem.id ? item : l
                      );
                  } else {
                      updatedList = [...lendList, item];
                  }
                  setLendList(updatedList);
              } else {
                  let updatedList;
                  if (editingItem) {
                      updatedList = borrowList.map(b => 
                          b.id === editingItem.id ? item : b
                      );
                  } else {
                      updatedList = [...borrowList, item];
                  }
                  setBorrowList(updatedList);
              }

              setShowAddForm(false);
              setEditingItem(null);
              setNewItem({ person: '', amount: '', description: '', date: new Date().toISOString().split('T')[0], paid: false });
          };

          const handleEditItem = (item) => {
              setEditingItem(item);
              setNewItem({
                  person: item.person,
                  amount: item.amount.toString(),
                  description: item.description,
                  date: item.date,
                  paid: item.paid
              });
              setShowAddForm(true);
          };

          const handleDeleteItem = (id) => {
              if (confirm('Are you sure you want to delete this item?')) {
                  if (activeSection === 'lend') {
                      setLendList(lendList.filter(item => item.id !== id));
                  } else {
                      setBorrowList(borrowList.filter(item => item.id !== id));
                  }
              }
          };

          const togglePaidStatus = (id) => {
              if (activeSection === 'lend') {
                  setLendList(lendList.map(item => 
                      item.id === id ? { ...item, paid: !item.paid } : item
                  ));
              } else {
                  setBorrowList(borrowList.map(item => 
                      item.id === id ? { ...item, paid: !item.paid } : item
                  ));
              }
          };

          const handleCancel = () => {
              setShowAddForm(false);
              setEditingItem(null);
              setNewItem({ person: '', amount: '', description: '', date: new Date().toISOString().split('T')[0], paid: false });
          };

          // Calculate totals
          const totalLent = lendList.reduce((sum, item) => sum + item.amount, 0);
          const totalBorrowed = borrowList.reduce((sum, item) => sum + item.amount, 0);
          const pendingLent = lendList.filter(item => !item.paid).reduce((sum, item) => sum + item.amount, 0);
          const pendingBorrowed = borrowList.filter(item => !item.paid).reduce((sum, item) => sum + item.amount, 0);

          const currentList = activeSection === 'lend' ? lendList : borrowList;

          return (
              <div>
                  {/* Summary Cards */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                      <div className={`rounded-lg shadow-md p-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                          <h3 className="text-lg font-medium mb-2">Lent Money</h3>
                          <p className="text-2xl font-bold text-yellow-500">Rs. {totalLent.toFixed(2)}</p>
                          <p className="text-sm text-gray-500 mt-1">
                              Pending: <span className="text-red-500">Rs. {pendingLent.toFixed(2)}</span>
                          </p>
                      </div>
                      <div className={`rounded-lg shadow-md p-6 ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                          <h3 className="text-lg font-medium mb-2">Borrowed Money</h3>
                          <p className="text-2xl font-bold text-blue-500">Rs. {totalBorrowed.toFixed(2)}</p>
                          <p className="text-sm text-gray-500 mt-1">
                              Pending: <span className="text-red-500">Rs. {pendingBorrowed.toFixed(2)}</span>
                          </p>
                      </div>
                  </div>

                  {/* Section Toggle and Add Button */}
                  <div className="flex justify-between items-center mb-6">
                      <div className="flex bg-gray-200 dark:bg-gray-700 rounded-lg p-1">
                          <button
                              onClick={() => setActiveSection('lend')}
                              className={`py-2 px-4 rounded-md text-sm font-medium ${
                                  activeSection === 'lend' 
                                      ? 'bg-white dark:bg-gray-600 shadow' 
                                      : 'text-gray-600 dark:text-gray-300'
                              }`}
                          >
                              Money Lent
                          </button>
                          <button
                              onClick={() => setActiveSection('borrow')}
                              className={`py-2 px-4 rounded-md text-sm font-medium ${
                                  activeSection === 'borrow' 
                                      ? 'bg-white dark:bg-gray-600 shadow' 
                                      : 'text-gray-600 dark:text-gray-300'
                              }`}
                          >
                              Money Borrowed
                          </button>
                      </div>
                      
                      <button
                          onClick={() => setShowAddForm(true)}
                          className="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center"
                      >
                          <PlusIcon />
                          <span className="ml-2">
                              Add {activeSection === 'lend' ? 'Lent' : 'Borrowed'} Money
                          </span>
                      </button>
                  </div>

                  {/* Add/Edit Form */}
                  {showAddForm && (
                      <div className={`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50`}>
                          <div className={`rounded-lg shadow-xl w-full max-w-md ${darkMode ? 'bg-gray-800' : 'bg-white'} p-6`}>
                              <h3 className="text-lg font-bold mb-4">
                                  {editingItem ? 'Edit' : 'Add'} {activeSection === 'lend' ? 'Lent' : 'Borrowed'} Money
                              </h3>
                              
                              <div className="space-y-4">
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                          Person Name
                                      </label>
                                      <input
                                          type="text"
                                          value={newItem.person}
                                          onChange={(e) => setNewItem({...newItem, person: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                          placeholder="Who did you lend/borrow from?"
                                      />
                                  </div>
                                  
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                          Amount (Rs.)
                                      </label>
                                      <input
                                          type="number"
                                          value={newItem.amount}
                                          onChange={(e) => setNewItem({...newItem, amount: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                          placeholder="0.00"
                                      />
                                  </div>
                                  
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                          Description
                                      </label>
                                      <input
                                          type="text"
                                          value={newItem.description}
                                          onChange={(e) => setNewItem({...newItem, description: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                          placeholder="What was this for?"
                                      />
                                  </div>
                                  
                                  <div>
                                      <label className={`block text-sm font-medium mb-1 ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                          Date
                                      </label>
                                      <input
                                          type="date"
                                          value={newItem.date}
                                          onChange={(e) => setNewItem({...newItem, date: e.target.value})}
                                          className={`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500 ${
                                              darkMode ? 'bg-gray-700 border-gray-600 text-white' : 'border-gray-300 text-gray-900'
                                          }`}
                                      />
                                  </div>
                                  
                                  <div className="flex items-center">
                                      <input
                                          type="checkbox"
                                          id="paid"
                                          checked={newItem.paid}
                                          onChange={(e) => setNewItem({...newItem, paid: e.target.checked})}
                                          className="h-4 w-4 text-green-500 rounded focus:ring-green-500"
                                      />
                                      <label htmlFor="paid" className={`ml-2 block text-sm ${darkMode ? 'text-gray-300' : 'text-gray-700'}`}>
                                          Mark as {activeSection === 'lend' ? 'returned' : 'paid back'}
                                      </label>
                                  </div>
                              </div>
                              
                              <div className="flex justify-end space-x-3 mt-6">
                                  <button
                                      onClick={handleCancel}
                                      className={`px-4 py-2 border rounded-md ${
                                          darkMode ? 'border-gray-600 text-gray-300 hover:bg-gray-700' : 'border-gray-300 text-gray-700 hover:bg-gray-50'
                                      }`}
                                  >
                                      Cancel
                                  </button>
                                  <button
                                      onClick={handleAddItem}
                                      className="px-4 py-2 bg-green-500 text-white rounded-md hover:bg-green-600"
                                  >
                                      {editingItem ? 'Update' : 'Add'} Record
                                  </button>
                              </div>
                          </div>
                      </div>
                  )}

                  {/* Items List */}
                  <div className={`rounded-lg shadow-md overflow-hidden ${darkMode ? 'bg-gray-800' : 'bg-white'}`}>
                      <div className="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
                          <h3 className="text-lg font-medium">
                              {activeSection === 'lend' ? 'Money Lent' : 'Money Borrowed'} 
                              ({currentList.filter(item => !item.paid).length} pending)
                          </h3>
                      </div>
                      
                      {currentList.length === 0 ? (
                          <div className="p-6 text-center text-gray-500">
                              No {activeSection === 'lend' ? 'lent' : 'borrowed'} money records yet.
                          </div>
                      ) : (
                          <div className="divide-y divide-gray-200 dark:divide-gray-700">
                              {currentList.map(item => (
                                  <div key={item.id} className="p-4 flex items-center justify-between">
                                      <div className="flex items-center">
                                          <button
                                              onClick={() => togglePaidStatus(item.id)}
                                              className={`w-6 h-6 rounded-full border-2 mr-3 flex items-center justify-center ${
                                                  item.paid 
                                                      ? 'bg-green-500 border-green-500 text-white' 
                                                      : 'border-gray-300 dark:border-gray-600'
                                              }`}
                                          >
                                              {item.paid && <CheckIcon />}
                                          </button>
                                          <div>
                                              <p className="font-medium">{item.person}</p>
                                              <div className="flex items-center text-sm text-gray-500">
                                                  <span>Rs. {item.amount.toFixed(2)}</span>
                                                  {item.description && (
                                                      <>
                                                          <span className="mx-2">‚Ä¢</span>
                                                          <span>{item.description}</span>
                                                      </>
                                                  )}
                                                  <span className="mx-2">‚Ä¢</span>
                                                  <span>{new Date(item.date).toLocaleDateString()}</span>
                                              </div>
                                          </div>
                                      </div>
                                      
                                      <div className="flex items-center">
                                          <span className={`mr-3 px-2 py-1 rounded-full text-xs ${
                                              item.paid 
                                                  ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' 
                                                  : 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'
                                          }`}>
                                              {item.paid 
                                                  ? (activeSection === 'lend' ? 'Returned' : 'Paid Back') 
                                                  : 'Pending'
                                              }
                                          </span>
                                          
                                          <div className="flex space-x-2">
                                              <button
                                                  onClick={() => handleEditItem(item)}
                                                  className="p-1 text-blue-500 hover:text-blue-700"
                                              >
                                                  <EditIcon />
                                              </button>
                                              <button
                                                  onClick={() => handleDeleteItem(item.id)}
                                                  className="p-1 text-red-500 hover:text-red-700"
                                              >
                                                  <DeleteIcon />
                                              </button>
                                          </div>
                                      </div>
                                  </div>
                              ))}
                          </div>
                      )}
                  </div>
              </div>
          );
      }

      // --- RENDER THE APP ---
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
</body>
</html>
